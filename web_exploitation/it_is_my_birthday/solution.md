# It is my birthday

## Write-Up

### Introduction

When accessing the website `http://mercury.picoctf.net:50970`, you can find an interface to introduce the two pdf files that are supposed to be the invitation to the party.

After multiple tests, here are the cases you may find :

 - When submitting two files that doesn't have the `.pdf` extension, you will receive the following error :

```
Not a pdf
```

 - When sending the same pdf file two times, you will receive the following error :

```
The two files are identical
```

 - When sending two different files (that obviously doesn't have the same md5 hash), you will send the following error :

```
The md5 is different
```

However, you can see that the server doesn't check for the file structure. Meaning that if you send two files that have the `.pdf` extension with only some bytes or a string in it, it will bypass the pdf check

### Solution

To solve this challenge, you need to send two pdf files that have two different content (the structure of the pdf is not important) but the same md5 hash. Appearantly, the author exploited the **MD5 Collision** vulnerability to submit the invitation.

To do that, you can do one of the two options :

 - Dowloand from the internet two pdf that occur to have the same md5 hash, you can find one via this website : https://github.com/corkami/collisions/tree/master/examples/free


 - Find two strings that have the same md5 hash, then put them in two different files (have different name and content), find two via this website : https://stackoverflow.com/questions/1756004/can-two-different-strings-generate-the-same-md5-hash-code

String 1 : 4dc968ff0ee35c209572d4777b721587d36fa7b21bdc56b74a3dc0783e7b9518afbfa200a8284bf36e8e4b55b35f427593d849676da0d1555d8360fb5f07fea2
String 2 : 4dc968ff0ee35c209572d4777b721587d36fa7b21bdc56b74a3dc0783e7b9518afbfa202a8284bf36e8e4b55b35f427593d849676da0d1d55d8360fb5f07fea2

 - Find two other files that have any other extension, and have different content but the same md5 hash, you can find two executables (`hello.exe` and `erase.exe`) via this website (Don't forget to change the extensions) : https://www.mathstat.dal.ca/~selinger/md5collision/

You can verify the files md5 hash via the [Hashing Calculator](./hash_calculator.py) python script.


## Flag

flag : picoCTF{c0ngr4ts_u_r_1nv1t3d_73b0c8ad}

## More information

MD5 collisions : https://github.com/corkami/collisions

Send post request using `curl` : https://linuxize.com/post/curl-post-request/

Calculate hash of a file : https://www.quickprogrammingtips.com/python/how-to-calculate-md5-hash-of-a-file-in-python.html

`md5_file` in php : https://www.php.net/manual/en/function.md5-file.php